import numpy as np
from keras.models import load_model
from sklearn.model_selection import train_test_split


# Choosing the size of input images.
h = 128
w = 128
# Choosing the proportion of dataset split.
test_size = 0.15
validation_size = 0.25
train_size = 0.6

# Load the trained model
model = load_model("trained_model.h5")

# Load your data
train_img_list = np.load("img_list.npy")
labels = np.load("labels.npy")

# Split the dataset for training and testing
train_x, test_x, train_y, test_y = train_test_split(
    np.asarray(train_img_list), np.asarray(labels), test_size=test_size, random_state=25
)

# Make predictions on the testing data
predictions = model.predict(test_x)

# Determine if each file is benign or malware
# results = []
# for prediction in predictions:
#     if prediction > 0.5:
#         results.append("Malware")
#     else:
#         results.append("Benign")

# You can now use the 'results' list to see the predictions for each file in the testing set
# For example, to print the first 10 predictions:
print(predictions[:10])
